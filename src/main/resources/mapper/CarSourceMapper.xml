<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tieshan.disintegrate.dao.CarSourceMapper">


    <insert id="insertBank" parameterType="com.tieshan.disintegrate.pojo.Bank">
        insert into ts_bank
            <trim prefix="(" suffixOverrides="," suffix=")">
                <if test="id != null and id != ''">
                    id,
                </if>
                <if test="disintegratePlantId != null and disintegratePlantId != ''">
                    disintegrate_plant_id,
                </if>
                <if test="bankName != null and bankName != ''">
                    bank_name,
                </if>
                <if test="bankBranch != null and bankBranch != ''">
                    bank_branch,
                </if>
                <if test="account != null and account !=''">
                    account,
                </if>
                <if test="payee != null and payee != ''">
                    payee,
                </if>
                <if test="createTime != null and createTime != ''">
                    create_time,
                </if>
                <if test="operatorId != null and operatorId != ''">
                    operator_id,
                </if>
                <if test="operator != null and operator != ''">
                    operator,
                </if>
                <if test="isDelete != null and isDelete != ''">
                    is_delete
                </if>
            </trim>
         VALUES
            <trim prefix="(" suffixOverrides="," suffix=")">
                <if test="id != null and id != ''">
                    #{id},
                </if>
                <if test="disintegratePlantId != null and disintegratePlantId != ''">
                    #{disintegratePlantId},
                </if>
                <if test="bankName != null and bankName != ''">
                    #{bankName},
                </if>
                <if test="bankBranch != null and bankBranch != ''">
                    #{bankBranch},
                </if>
                <if test="account != null and account !=''">
                    #{account},
                </if>
                <if test="payee != null and payee != ''">
                    #{payee},
                </if>
                <if test="createTime != null and createTime != ''">
                    #{createTime},
                </if>
                <if test="operatorId != null and operatorId != ''">
                    #{operatorId},
                </if>
                <if test="operator != null and operator != ''">
                    #{operator},
                </if>
                <if test="isDelete != null and isDelete != ''">
                    #{isDelete}
                </if>
            </trim>
    </insert>

    <insert id="insertCarSource" parameterType="com.tieshan.disintegrate.pojo.CarSource">
        insert into ts_car_source
        <trim prefix="(" suffixOverrides="," suffix=")">
            <if test="id != null and id != ''">
                id,
            </if>
            <if test="disintegratePlantId != null and disintegratePlantId != ''">
                disintegrate_plant_id,
            </if>
            <if test="contacts != null and contacts != ''">
                contacts,
            </if>
            <if test="phone != null and phone != ''">
                phone,
            </if>
            <if test="count != null and count !=''">
                count,
            </if>
            <if test="carLocation != null and carLocation != ''">
                car_location,
            </if>
            <if test="userId != null and userId != ''">
                user_id,
            </if>
            <if test="bankId != null and bankId != ''">
                operator_id,
            </if>
            <if test="payType != null and payType != ''">
                pay_type,
            </if>
            <if test="payStatus != null and payStatus != ''">
                pay_Status,
            </if>
            <if test="payAmount != null and payAmount !=''">
                pay_amount,
            </if>
            <if test="createSource != null and createSource != ''">
                create_source,
            </if>
            <if test="createOperator != null and createOperator != ''">
                create_operator,
            </if>
            <if test="createOperatorId != null and createOperatorId != ''">
                create_operator_id,
            </if>
            <if test="createTime != null and createTime != ''">
                create_time,
            </if>
            <if test="isDelete != null and isDelete != ''">
                is_delete
            </if>
        </trim>
         VALUES
        <trim prefix="(" suffixOverrides="," suffix=")">
            <if test="id != null and id != ''">
                #{id},
            </if>
            <if test="disintegratePlantId != null and disintegratePlantId != ''">
                #{disintegratePlantId},
            </if>
            <if test="contacts != null and contacts != ''">
                #{contacts},
            </if>
            <if test="phone != null and phone != ''">
                #{phone},
            </if>
            <if test="count != null and count !=''">
                #{count},
            </if>
            <if test="carLocation != null and carLocation != ''">
                #{carLocation},
            </if>
            <if test="userId != null and userId != ''">
                #{userId},
            </if>
            <if test="bankId != null and bankId != ''">
                #{bankId},
            </if>
            <if test="payType != null and payType != ''">
                #{payType},
            </if>
            <if test="payStatus != null and payStatus != ''">
                #{payStatus},
            </if>
            <if test="payAmount != null and payAmount !=''">
                #{payAmount},
            </if>
            <if test="createSource != null and createSource != ''">
                #{createSource},
            </if>
            <if test="createOperator != null and createOperator != ''">
                #{createOperator},
            </if>
            <if test="createOperatorId != null and createOperatorId != ''">
                #{createOperatorId},
            </if>
            <if test="createTime != null and createTime != ''">
                #{createTime},
            </if>
            <if test="isDelete != null and isDelete != ''">
                #{isDelete}
            </if>
        </trim>
    </insert>

    <select id="selectCarSourceList" parameterType="java.lang.String" resultType="java.util.Map">
        SELECT
            IFNULL(id, '') AS id,
            IFNULL(create_time, '') AS createTime,
	        IFNULL(contacts, '') AS contacts,
	        IFNULL(phone,'') AS phone,
	        IFNULL(car_location,'') AS carLocation,
			CONCAT(IFNULL(bank_name,''),',',IFNULL(bank_branch,''),',',IFNULL(account,'')) AS bankMessage
        FROM
	        ts_car_source LEFT JOIN ts_bank
        ON
	        source_type = #{sourceType};
    </select>


    <select id="selectProcessingTypeOrProceduresType" parameterType="java.lang.String" resultType="java.lang.String">
		SELECT
 			IFNULL(filed_name,'') AS filedName
		FROM
			ts_dictionary
		WHERE
			first_type = #{firstName};
	</select>

    <insert id="addCar" parameterType="com.tieshan.disintegrate.pojo.CarInfo">
        insert into ts_car_info
        <trim prefix="(" suffixOverrides="," suffix=")">
            <if test="id != null and id != ''">
                id,
            </if>
            <if test="disintegratePlantId != null and disintegratePlantId != ''">
                disintegrate_plant_id,
            </if>
            <if test="carSource != null and carSource != ''">
                car_source,
            </if>
            <if test="contacts != null and contacts != ''">
                contacts,
            </if>
            <if test="contactsPhone != null and contactsPhone !=''">
                contactsPhone,
            </if>
            <if test="carNo != null and carNo != ''">
                car_no,
            </if>
            <if test="processingType != null and processingType != ''">
                processing_type,
            </if>
            <if test="processingDate != null and processingDate != ''">
                processing_date,
            </if>
            <if test="procedures != null and procedures != ''">
                procedures,
            </if>
            <if test="proceduresType != null and proceduresType != ''">
                procedures_type,
            </if>
            <if test="remarks != null and remarks !=''">
                remarks,
            </if>
            <if test="createTime != null and createTime != ''">
                create_time,
            </if>
            <if test="operatorId != null and operatorId != ''">
                operator_id,
            </if>
            <if test="operator != null and operator != ''">
                operator,
            </if>
            <if test="carName != null and carName != ''">
                car_name,
            </if>
            <if test="isDelete != null and isDelete != ''">
                is_delete,
            </if>
            <if test="contactsAddress != null and contactsAddress != ''">
                contacts_address
            </if>
        </trim>
        VALUES
        <trim prefix="(" suffixOverrides="," suffix=")">
            <if test="id != null and id != ''">
                #{id},
            </if>
            <if test="disintegratePlantId != null and disintegratePlantId != ''">
                #{disintegratePlantId},
            </if>
            <if test="carSource != null and carSource != ''">
                #{carSource},
            </if>
            <if test="contacts != null and contacts != ''">
                #{contacts},
            </if>
            <if test="contactsPhone != null and contactsPhone !=''">
                #{contactsPhone},
            </if>
            <if test="carNo != null and carNo != ''">
                #{carNo},
            </if>
            <if test="processingType != null and processingType != ''">
                #{processingType},
            </if>
            <if test="processingDate != null and processingDate != ''">
                #{processingDate},
            </if>
            <if test="procedures != null and procedures != ''">
                #{procedures},
            </if>
            <if test="proceduresType != null and proceduresType != ''">
                #{proceduresType},
            </if>
            <if test="remarks != null and remarks !=''">
                #{remarks},
            </if>
            <if test="createTime != null and createTime != ''">
                #{createTime},
            </if>
            <if test="operatorId != null and operatorId != ''">
                #{operatorId},
            </if>
            <if test="operator != null and operator != ''">
                #{operator},
            </if>
            <if test="carName != null and carName != ''">
                #{carName},
            </if>
            <if test="isDelete != null and isDelete != ''">
                #{isDelete},
            </if>
            <if test="contactsAddress != null and contactsAddress != ''">
                #{contactsAddress}
            </if>
        </trim>
    </insert>

    <select id="selectCarSource" parameterType="java.lang.Long" resultType="com.tieshan.disintegrate.pojo.CarSource">
        SELECT
            IFNULL(id,'') AS id,
	        IFNULL(create_time,'') AS createTime,
	        IFNULL(contacts,'') AS contacts,
	        IFNULL(phone,'') AS contactsPhone,
            IFNULL(count,'') AS count,
	        IFNULL(car_location,'') AS carLocation
        FROM
	        ts_car_source
        WHERE
	        id = #{id};
    </select>
</mapper>